<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>crypto | Miguel's Programing Notes</title>
    <link rel="stylesheet" href="/assets/css/styles.css">
</head>
<body>
    <div class="app">
        <nav class="navbar">
    <div class="nav-container">
        <a href="/" class="nav-brand">
            Miguel's Programming Notes
        </a>

        <div class="nav-sections">
            
                
                
                
                <a href="/paquetes/"
                    class="nav-section active"
                    data-section="paquetes">
                    游닍 Paquetes
                </a>
            
                
                
                
                <a href="/ejemplos/"
                    class="nav-section "
                    data-section="ejemplos">
                    游빌 Ejemplos
                </a>
            
        </div>
    </div>
</nav>
        
        <div class="container">
            <button class="menu-toggle" aria-label="Abrir men칰">
                <span></span>
                <span></span>
                <span></span>
            </button>
            
            <aside class="sidebar" id="dynamic-sidebar">
    <div class="sidebar-header">
        <h3 class="sidebar-title">Miguel's Programming Notes</h3>
    </div>
    
    <div class="sidebar-content">
        
            
                <h3 class="sidebar-title">游닍 Paquetes</h3>
                <nav class="sidebar-nav">
                    
                        <a href="/paquetes/fmt/"
                            class="sidebar-item "
                            data-item="fmt">
                            fmt
                        </a>
                    
                        <a href="/paquetes/net/"
                            class="sidebar-item "
                            data-item="net-http">
                            net/http
                        </a>
                    
                        <a href="/paquetes/encoding/"
                            class="sidebar-item "
                            data-item="encoding">
                            encoding
                        </a>
                    
                </nav>
            
        
            
        
    </div>
</aside>
            
            <main class="content">
                <h1 id="paquete-crypto-en-go">Paquete crypto en Go</h1>

<p>El paquete <code class="language-plaintext highlighter-rouge">crypto</code> en Go es una colecci칩n de subpaquetes que proporcionan diversas funcionalidades criptogr치ficas. Este documento explora en detalle cada subpaquete con ejemplos pr치cticos y casos de uso.</p>

<h2 id="1-cryptoaes-advanced-encryption-standard">1. crypto/aes (Advanced Encryption Standard)</h2>

<h3 id="11-cifrado-aes-gcm">1.1 Cifrado AES-GCM</h3>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">ejemploAESGCM</span><span class="p">()</span> <span class="p">{</span>
    <span class="c">// Clave debe ser de 16, 24 o 32 bytes (para AES-128, AES-192 o AES-256)</span>
    <span class="n">key</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">byte</span><span class="p">,</span> <span class="m">32</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">io</span><span class="o">.</span><span class="n">ReadFull</span><span class="p">(</span><span class="n">rand</span><span class="o">.</span><span class="n">Reader</span><span class="p">,</span> <span class="n">key</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="nb">panic</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c">// Crear cipher block</span>
    <span class="n">block</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">aes</span><span class="o">.</span><span class="n">NewCipher</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">panic</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c">// Crear GCM (Galois/Counter Mode)</span>
    <span class="n">gcm</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">NewGCM</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">panic</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c">// Crear nonce</span>
    <span class="n">nonce</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">byte</span><span class="p">,</span> <span class="n">gcm</span><span class="o">.</span><span class="n">NonceSize</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">io</span><span class="o">.</span><span class="n">ReadFull</span><span class="p">(</span><span class="n">rand</span><span class="o">.</span><span class="n">Reader</span><span class="p">,</span> <span class="n">nonce</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="nb">panic</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c">// Datos a cifrar</span>
    <span class="n">plaintext</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">(</span><span class="s">"Informaci칩n secreta"</span><span class="p">)</span>

    <span class="c">// Cifrar</span>
    <span class="n">ciphertext</span> <span class="o">:=</span> <span class="n">gcm</span><span class="o">.</span><span class="n">Seal</span><span class="p">(</span><span class="no">nil</span><span class="p">,</span> <span class="n">nonce</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">,</span> <span class="no">nil</span><span class="p">)</span>

    <span class="c">// Descifrar</span>
    <span class="n">plaintext2</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">gcm</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="no">nil</span><span class="p">,</span> <span class="n">nonce</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">,</span> <span class="no">nil</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="nb">panic</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"Texto original: %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">)</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"Texto descifrado: %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">plaintext2</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="12-cifrar-archivo-con-aes">1.2 Cifrar Archivo con AES</h3>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">cifrarArchivo</span><span class="p">(</span><span class="n">inputPath</span><span class="p">,</span> <span class="n">outputPath</span> <span class="kt">string</span><span class="p">,</span> <span class="n">key</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
    <span class="c">// Abrir archivo de entrada</span>
    <span class="n">input</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">os</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">inputPath</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">err</span>
    <span class="p">}</span>
    <span class="k">defer</span> <span class="n">input</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>

    <span class="c">// Crear archivo de salida</span>
    <span class="n">output</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">os</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="n">outputPath</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">err</span>
    <span class="p">}</span>
    <span class="k">defer</span> <span class="n">output</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>

    <span class="c">// Crear cipher block</span>
    <span class="n">block</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">aes</span><span class="o">.</span><span class="n">NewCipher</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">err</span>
    <span class="p">}</span>

    <span class="c">// Crear GCM</span>
    <span class="n">gcm</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">NewGCM</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">err</span>
    <span class="p">}</span>

    <span class="c">// Crear nonce</span>
    <span class="n">nonce</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">byte</span><span class="p">,</span> <span class="n">gcm</span><span class="o">.</span><span class="n">NonceSize</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">io</span><span class="o">.</span><span class="n">ReadFull</span><span class="p">(</span><span class="n">rand</span><span class="o">.</span><span class="n">Reader</span><span class="p">,</span> <span class="n">nonce</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">err</span>
    <span class="p">}</span>

    <span class="c">// Escribir nonce al inicio del archivo</span>
    <span class="k">if</span> <span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">output</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">nonce</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">err</span>
    <span class="p">}</span>

    <span class="c">// Crear writer con cifrado</span>
    <span class="n">writer</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">cipher</span><span class="o">.</span><span class="n">StreamWriter</span><span class="p">{</span>
        <span class="n">S</span><span class="o">:</span> <span class="n">cipher</span><span class="o">.</span><span class="n">NewCTR</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="n">nonce</span><span class="p">),</span>
        <span class="n">W</span><span class="o">:</span> <span class="n">output</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c">// Copiar y cifrar datos</span>
    <span class="k">if</span> <span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">io</span><span class="o">.</span><span class="n">Copy</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">input</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">err</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="no">nil</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="2-cryptorsa">2. crypto/rsa</h2>

<h3 id="21-cifrado-y-descifrado-rsa">2.1 Cifrado y Descifrado RSA</h3>
<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
    <span class="s">"crypto/rand"</span>
    <span class="s">"crypto/rsa"</span>
    <span class="s">"crypto/sha256"</span>
    <span class="s">"fmt"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">privateKey</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">rsa</span><span class="o">.</span><span class="n">GenerateKey</span><span class="p">(</span><span class="n">rand</span><span class="o">.</span><span class="n">Reader</span><span class="p">,</span> <span class="m">2048</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="nb">panic</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="n">publicKey</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">privateKey</span><span class="o">.</span><span class="n">PublicKey</span>
    <span class="n">message</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">(</span><span class="s">"Hello, world!"</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">(</span><span class="s">""</span><span class="p">)</span>
    <span class="n">hash</span> <span class="o">:=</span> <span class="n">sha256</span><span class="o">.</span><span class="n">New</span><span class="p">()</span>

    <span class="n">ciphertext</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">rsa</span><span class="o">.</span><span class="n">EncryptOAEP</span><span class="p">(</span><span class="n">hash</span><span class="p">,</span> <span class="n">rand</span><span class="o">.</span><span class="n">Reader</span><span class="p">,</span> <span class="n">publicKey</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="nb">panic</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"Encrypted message: %x</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">)</span>

    <span class="n">plaintext</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">rsa</span><span class="o">.</span><span class="n">DecryptOAEP</span><span class="p">(</span><span class="n">hash</span><span class="p">,</span> <span class="n">rand</span><span class="o">.</span><span class="n">Reader</span><span class="p">,</span> <span class="n">privateKey</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="nb">panic</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"Decrypted message: %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="22-generar-y-guardar-claves-rsa">2.2 Generar y Guardar Claves RSA</h3>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">generarGuardarClaves</span><span class="p">()</span> <span class="kt">error</span> <span class="p">{</span>
    <span class="c">// Generar par de claves</span>
    <span class="n">privateKey</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">rsa</span><span class="o">.</span><span class="n">GenerateKey</span><span class="p">(</span><span class="n">rand</span><span class="o">.</span><span class="n">Reader</span><span class="p">,</span> <span class="m">4096</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">err</span>
    <span class="p">}</span>

    <span class="c">// Convertir a PEM</span>
    <span class="n">privateKeyPEM</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">pem</span><span class="o">.</span><span class="n">Block</span><span class="p">{</span>
        <span class="n">Type</span><span class="o">:</span>  <span class="s">"RSA PRIVATE KEY"</span><span class="p">,</span>
        <span class="n">Bytes</span><span class="o">:</span> <span class="n">x509</span><span class="o">.</span><span class="n">MarshalPKCS1PrivateKey</span><span class="p">(</span><span class="n">privateKey</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="n">publicKeyPEM</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">pem</span><span class="o">.</span><span class="n">Block</span><span class="p">{</span>
        <span class="n">Type</span><span class="o">:</span>  <span class="s">"RSA PUBLIC KEY"</span><span class="p">,</span>
        <span class="n">Bytes</span><span class="o">:</span> <span class="n">x509</span><span class="o">.</span><span class="n">MarshalPKCS1PublicKey</span><span class="p">(</span><span class="o">&amp;</span><span class="n">privateKey</span><span class="o">.</span><span class="n">PublicKey</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="c">// Guardar clave privada</span>
    <span class="n">privateKeyFile</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">os</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="s">"private.pem"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">err</span>
    <span class="p">}</span>
    <span class="k">defer</span> <span class="n">privateKeyFile</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">pem</span><span class="o">.</span><span class="n">Encode</span><span class="p">(</span><span class="n">privateKeyFile</span><span class="p">,</span> <span class="n">privateKeyPEM</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">err</span>
    <span class="p">}</span>

    <span class="c">// Guardar clave p칰blica</span>
    <span class="n">publicKeyFile</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">os</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="s">"public.pem"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">err</span>
    <span class="p">}</span>
    <span class="k">defer</span> <span class="n">publicKeyFile</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">pem</span><span class="o">.</span><span class="n">Encode</span><span class="p">(</span><span class="n">publicKeyFile</span><span class="p">,</span> <span class="n">publicKeyPEM</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="23-firmar-y-verificar-documentos-con-rsa">2.3 Firmar y Verificar Documentos con RSA</h3>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="n">DocumentoFirmado</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">Contenido</span>    <span class="p">[]</span><span class="kt">byte</span>
    <span class="n">Firma</span>        <span class="p">[]</span><span class="kt">byte</span>
    <span class="n">FechaFirma</span>   <span class="n">time</span><span class="o">.</span><span class="n">Time</span>
    <span class="n">FirmadoPor</span>   <span class="kt">string</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">firmarDocumento</span><span class="p">(</span><span class="n">documento</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">,</span> <span class="n">privateKey</span> <span class="o">*</span><span class="n">rsa</span><span class="o">.</span><span class="n">PrivateKey</span><span class="p">,</span> <span class="n">firmadoPor</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="o">*</span><span class="n">DocumentoFirmado</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c">// Calcular hash del documento</span>
    <span class="n">hashed</span> <span class="o">:=</span> <span class="n">sha256</span><span class="o">.</span><span class="n">Sum256</span><span class="p">(</span><span class="n">documento</span><span class="p">)</span>

    <span class="c">// Firmar el hash</span>
    <span class="n">firma</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">rsa</span><span class="o">.</span><span class="n">SignPSS</span><span class="p">(</span><span class="n">rand</span><span class="o">.</span><span class="n">Reader</span><span class="p">,</span> <span class="n">privateKey</span><span class="p">,</span> <span class="n">crypto</span><span class="o">.</span><span class="n">SHA256</span><span class="p">,</span> <span class="n">hashed</span><span class="p">[</span><span class="o">:</span><span class="p">],</span> <span class="no">nil</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="no">nil</span><span class="p">,</span> <span class="n">err</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="o">&amp;</span><span class="n">DocumentoFirmado</span><span class="p">{</span>
        <span class="n">Contenido</span><span class="o">:</span>    <span class="n">documento</span><span class="p">,</span>
        <span class="n">Firma</span><span class="o">:</span>        <span class="n">firma</span><span class="p">,</span>
        <span class="n">FechaFirma</span><span class="o">:</span>   <span class="n">time</span><span class="o">.</span><span class="n">Now</span><span class="p">(),</span>
        <span class="n">FirmadoPor</span><span class="o">:</span>   <span class="n">firmadoPor</span><span class="p">,</span>
    <span class="p">},</span> <span class="no">nil</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">verificarFirma</span><span class="p">(</span><span class="n">doc</span> <span class="o">*</span><span class="n">DocumentoFirmado</span><span class="p">,</span> <span class="n">publicKey</span> <span class="o">*</span><span class="n">rsa</span><span class="o">.</span><span class="n">PublicKey</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
    <span class="c">// Calcular hash del documento</span>
    <span class="n">hashed</span> <span class="o">:=</span> <span class="n">sha256</span><span class="o">.</span><span class="n">Sum256</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">Contenido</span><span class="p">)</span>

    <span class="c">// Verificar firma</span>
    <span class="k">return</span> <span class="n">rsa</span><span class="o">.</span><span class="n">VerifyPSS</span><span class="p">(</span><span class="n">publicKey</span><span class="p">,</span> <span class="n">crypto</span><span class="o">.</span><span class="n">SHA256</span><span class="p">,</span> <span class="n">hashed</span><span class="p">[</span><span class="o">:</span><span class="p">],</span> <span class="n">doc</span><span class="o">.</span><span class="n">Firma</span><span class="p">,</span> <span class="no">nil</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="3-cryptomd5">3. crypto/md5</h2>

<h3 id="31-hash-md5">3.1 Hash MD5</h3>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
    <span class="s">"crypto/md5"</span>
    <span class="s">"fmt"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">data</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">(</span><span class="s">"Hello, world!"</span><span class="p">)</span>
    <span class="n">hash</span> <span class="o">:=</span> <span class="n">md5</span><span class="o">.</span><span class="n">Sum</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"MD5 hash: %x</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">hash</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="4-cryptosha256">4. crypto/sha256</h2>

<h3 id="41-hash-sha-256">4.1 Hash SHA-256</h3>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
    <span class="s">"crypto/sha256"</span>
    <span class="s">"fmt"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">data</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">(</span><span class="s">"Hello, world!"</span><span class="p">)</span>
    <span class="n">hash</span> <span class="o">:=</span> <span class="n">sha256</span><span class="o">.</span><span class="n">Sum256</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"SHA-256 hash: %x</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">hash</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="5-cryptohmac">5. crypto/hmac</h2>

<h3 id="51-hmac-con-sha-256">5.1 HMAC con SHA-256</h3>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
    <span class="s">"crypto/hmac"</span>
    <span class="s">"crypto/sha256"</span>
    <span class="s">"fmt"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">key</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">(</span><span class="s">"secret key"</span><span class="p">)</span>
    <span class="n">message</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">(</span><span class="s">"Hello, world!"</span><span class="p">)</span>

    <span class="n">hash</span> <span class="o">:=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">New</span><span class="p">(</span><span class="n">sha256</span><span class="o">.</span><span class="n">New</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
    <span class="n">hash</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="n">sum</span> <span class="o">:=</span> <span class="n">hash</span><span class="o">.</span><span class="n">Sum</span><span class="p">(</span><span class="no">nil</span><span class="p">)</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"HMAC: %x</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">sum</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="52-crear-y-verificar-mensaje-autenticado">5.2 Crear y Verificar Mensaje Autenticado</h3>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="n">MensajeAutenticado</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">Contenido</span>   <span class="p">[]</span><span class="kt">byte</span>
    <span class="n">HMAC</span>        <span class="p">[]</span><span class="kt">byte</span>
    <span class="n">Timestamp</span>   <span class="n">time</span><span class="o">.</span><span class="n">Time</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">crearMensajeAutenticado</span><span class="p">(</span><span class="n">contenido</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">,</span> <span class="n">key</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">)</span> <span class="o">*</span><span class="n">MensajeAutenticado</span> <span class="p">{</span>
    <span class="n">h</span> <span class="o">:=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">New</span><span class="p">(</span><span class="n">sha256</span><span class="o">.</span><span class="n">New</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
    <span class="n">h</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">contenido</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="o">&amp;</span><span class="n">MensajeAutenticado</span><span class="p">{</span>
        <span class="n">Contenido</span><span class="o">:</span> <span class="n">contenido</span><span class="p">,</span>
        <span class="n">HMAC</span><span class="o">:</span>     <span class="n">h</span><span class="o">.</span><span class="n">Sum</span><span class="p">(</span><span class="no">nil</span><span class="p">),</span>
        <span class="n">Timestamp</span><span class="o">:</span> <span class="n">time</span><span class="o">.</span><span class="n">Now</span><span class="p">(),</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">verificarMensaje</span><span class="p">(</span><span class="n">mensaje</span> <span class="o">*</span><span class="n">MensajeAutenticado</span><span class="p">,</span> <span class="n">key</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">)</span> <span class="kt">bool</span> <span class="p">{</span>
    <span class="n">h</span> <span class="o">:=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">New</span><span class="p">(</span><span class="n">sha256</span><span class="o">.</span><span class="n">New</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
    <span class="n">h</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">mensaje</span><span class="o">.</span><span class="n">Contenido</span><span class="p">)</span>
    <span class="n">expectedHMAC</span> <span class="o">:=</span> <span class="n">h</span><span class="o">.</span><span class="n">Sum</span><span class="p">(</span><span class="no">nil</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">hmac</span><span class="o">.</span><span class="n">Equal</span><span class="p">(</span><span class="n">mensaje</span><span class="o">.</span><span class="n">HMAC</span><span class="p">,</span> <span class="n">expectedHMAC</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="subpaquetes-adicionales-en-crypto">Subpaquetes adicionales en <code class="language-plaintext highlighter-rouge">crypto</code></h3>

<ul>
  <li><strong><code class="language-plaintext highlighter-rouge">crypto/ecdsa</code></strong>: Implementa las funciones para la firma y verificaci칩n con el algoritmo ECDSA (Elliptic Curve Digital Signature Algorithm).</li>
  <li><strong><code class="language-plaintext highlighter-rouge">crypto/elliptic</code></strong>: Implementa las curvas el칤pticas utilizadas en criptograf칤a.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">crypto/des</code></strong>: Implementa el cifrado y descifrado seg칰n el est치ndar DES (Data Encryption Standard) y Triple DES.</li>
</ul>

<h3 id="descripci칩n-general">Descripci칩n General</h3>

<ol>
  <li><strong><code class="language-plaintext highlighter-rouge">crypto/aes</code></strong>: Cifrado y descifrado sim칠trico seg칰n AES.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">crypto/rsa</code></strong>: Cifrado, descifrado, firma y verificaci칩n seg칰n RSA.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">crypto/md5</code></strong>: Algoritmo de hash MD5 (no recomendado para criptograf칤a).</li>
  <li><strong><code class="language-plaintext highlighter-rouge">crypto/sha256</code></strong>: Algoritmo de hash SHA-256.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">crypto/hmac</code></strong>: Algoritmo HMAC para autenticaci칩n e integridad de mensajes.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">crypto/ecdsa</code></strong>: Firma y verificaci칩n con ECDSA.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">crypto/elliptic</code></strong>: Implementaciones de curvas el칤pticas.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">crypto/des</code></strong>: Cifrado y descifrado seg칰n DES y Triple DES.</li>
</ol>

<p>Estos son algunos de los componentes m치s importantes del paquete <code class="language-plaintext highlighter-rouge">crypto</code> en Go. Cada uno de estos subpaquetes ofrece herramientas esenciales para implementar diversas funcionalidades criptogr치ficas. Si necesitas m치s informaci칩n o ejemplos sobre alg칰n subpaquete en particular, 춰h치blame! Estoy aqu칤 para ayudarte.</p>

<h2 id="6-generar-contrase침as-seguras">6. Generar Contrase침as Seguras</h2>

<h3 id="61-generar-contrase침a-aleatoria">6.1 Generar Contrase침a Aleatoria</h3>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">generarPassword</span><span class="p">(</span><span class="n">longitud</span> <span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">const</span> <span class="n">charset</span> <span class="o">=</span> <span class="s">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&amp;*()-_=+"</span>
    <span class="n">bytes</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">byte</span><span class="p">,</span> <span class="n">longitud</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">rand</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">bytes</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">""</span><span class="p">,</span> <span class="n">err</span>
    <span class="p">}</span>
    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">bytes</span> <span class="p">{</span>
        <span class="n">bytes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">charset</span><span class="p">[</span><span class="n">b</span><span class="o">%</span><span class="kt">byte</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">charset</span><span class="p">))]</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="kt">string</span><span class="p">(</span><span class="n">bytes</span><span class="p">),</span> <span class="no">nil</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="62-hash-de-contrase침a">6.2 Hash de Contrase침a</h3>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">hashPassword</span><span class="p">(</span><span class="n">password</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c">// Generar salt aleatorio</span>
    <span class="n">salt</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">byte</span><span class="p">,</span> <span class="m">16</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">rand</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">salt</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">""</span><span class="p">,</span> <span class="n">err</span>
    <span class="p">}</span>

    <span class="c">// Derivar clave usando Argon2</span>
    <span class="n">key</span> <span class="o">:=</span> <span class="n">argon2</span><span class="o">.</span><span class="n">IDKey</span><span class="p">([]</span><span class="kt">byte</span><span class="p">(</span><span class="n">password</span><span class="p">),</span> <span class="n">salt</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">64</span><span class="o">*</span><span class="m">1024</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">32</span><span class="p">)</span>

    <span class="c">// Codificar resultado</span>
    <span class="n">encoded</span> <span class="o">:=</span> <span class="n">base64</span><span class="o">.</span><span class="n">StdEncoding</span><span class="o">.</span><span class="n">EncodeToString</span><span class="p">(</span><span class="nb">append</span><span class="p">(</span><span class="n">salt</span><span class="p">,</span> <span class="n">key</span><span class="o">...</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">encoded</span><span class="p">,</span> <span class="no">nil</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="mejores-pr치cticas">Mejores Pr치cticas</h3>

<ul>
  <li>Gesti칩n de Claves
    <ul>
      <li>Almacenar claves de forma segura</li>
      <li>Rotar claves peri칩dicamente</li>
      <li>Usar generadores de n칰meros aleatorios seguros</li>
    </ul>
  </li>
  <li>Manejo de Errores
    <ul>
      <li>Validar entradas</li>
      <li>Manejar errores criptogr치ficos apropiadamente</li>
      <li>No exponer informaci칩n sensible en errores</li>
    </ul>
  </li>
  <li>Consideraciones de Rendimiento
    <ul>
      <li>Usar b칰fers para operaciones grandes</li>
      <li>Implementar cach칠 cuando sea apropiado</li>
      <li>Considerar operaciones concurrentes</li>
    </ul>
  </li>
</ul>

            </main>
        </div>
        
        <!-- Componente flotante de GitHub -->
<div class="github-floating">
    <a href="https://github.com/" target="_blank" rel="noopener noreferrer" class="github-link" title="Ver en GitHub">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github">
            <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
        </svg>
    </a>
    
    
    <a href="https://github.com//MiguelP-Dev.github.io/blob/main/_pages/paquetes/crypto.md" target="_blank" rel="noopener noreferrer" class="edit-link" title="Editar esta p치gina">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2">
            <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>
        </svg>
    </a>
    
</div>

<style>
    /* Estilos del componente SVG */
    .github-corner:hover .octo-arm {
        animation: octocat-wave 560ms ease-in-out;
    }
    
    @keyframes octocat-wave {
        0%, 100% { transform: rotate(0); }
        20%, 60% { transform: rotate(-25deg); }
        40%, 80% { transform: rotate(10deg); }
    }
    
    @media (max-width: 500px) {
        .github-corner:hover .octo-arm {
            animation: none;
        }
        .github-corner .octo-arm {
            animation: octocat-wave 560ms ease-in-out;
        }
    }
</style>
    </div>
    
    <script src="/assets/js/scripts.js"></script>
</body>
</html>