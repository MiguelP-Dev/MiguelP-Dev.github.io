<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>json | Miguel's Programing Notes</title>
    <link rel="stylesheet" href="/assets/css/styles.css">
</head>
<body>
    <div class="app">
        <nav class="navbar">
    <div class="nav-container">
        <a href="/" class="nav-brand">
            Miguel's Programming Notes
        </a>

        <div class="nav-sections">
            
                
                
                
                <a href="/paquetes/"
                    class="nav-section active"
                    data-section="paquetes">
                    📦 Paquetes
                </a>
            
                
                
                
                <a href="/ejemplos/"
                    class="nav-section "
                    data-section="ejemplos">
                    🧩 Ejemplos
                </a>
            
        </div>
    </div>
</nav>
        
        <div class="container">
            <button class="menu-toggle" aria-label="Abrir menú">
                <span></span>
                <span></span>
                <span></span>
            </button>
            
            <aside class="sidebar" id="dynamic-sidebar">
    <div class="sidebar-header">
        <h3 class="sidebar-title">Miguel's Programming Notes</h3>
    </div>
    
    <div class="sidebar-content">
        
            
                <h3 class="sidebar-title">📦 Paquetes</h3>
                <nav class="sidebar-nav">
                    
                        <a href="/paquetes/fmt/"
                            class="sidebar-item "
                            data-item="fmt">
                            fmt
                        </a>
                    
                        <a href="/paquetes/net/"
                            class="sidebar-item "
                            data-item="net-http">
                            net/http
                        </a>
                    
                        <a href="/paquetes/encoding/"
                            class="sidebar-item "
                            data-item="encoding">
                            encoding
                        </a>
                    
                </nav>
            
        
            
        
    </div>
</aside>
            
            <main class="content">
                <h1 id="paquete-encodingjson-en-go">Paquete <code class="language-plaintext highlighter-rouge">encoding/json</code> en Go</h1>

<p>El paquete <code class="language-plaintext highlighter-rouge">encoding/json</code> proporciona herramientas para trabajar con datos JSON en Go. Esta guía cubre desde lo básico hasta técnicas avanzadas de serialización y deserialización.</p>

<h2 id="1-conceptos-básicos">1. Conceptos Básicos</h2>

<h3 id="11-serialización-marshal">1.1 Serialización (Marshal)</h3>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
    <span class="s">"encoding/json"</span>
    <span class="s">"fmt"</span>
    <span class="s">"log"</span>
<span class="p">)</span>

<span class="k">type</span> <span class="n">Usuario</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">ID</span>        <span class="kt">int</span>      <span class="s">`json:"id"`</span>
    <span class="n">Nombre</span>    <span class="kt">string</span>   <span class="s">`json:"nombre"`</span>
    <span class="n">Email</span>     <span class="kt">string</span>   <span class="s">`json:"email,omitempty"`</span>
    <span class="n">Activo</span>    <span class="kt">bool</span>     <span class="s">`json:"activo"`</span>
    <span class="n">Etiquetas</span> <span class="p">[]</span><span class="kt">string</span> <span class="s">`json:"etiquetas,omitempty"`</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">usuario</span> <span class="o">:=</span> <span class="n">Usuario</span><span class="p">{</span>
        <span class="n">ID</span><span class="o">:</span>        <span class="m">1</span><span class="p">,</span>
        <span class="n">Nombre</span><span class="o">:</span>    <span class="s">"Ana García"</span><span class="p">,</span>
        <span class="n">Email</span><span class="o">:</span>     <span class="s">"ana@ejemplo.com"</span><span class="p">,</span>
        <span class="n">Activo</span><span class="o">:</span>    <span class="no">true</span><span class="p">,</span>
        <span class="n">Etiquetas</span><span class="o">:</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="s">"admin"</span><span class="p">,</span> <span class="s">"desarrollador"</span><span class="p">},</span>
    <span class="p">}</span>
    
    <span class="c">// Convertir a JSON</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">json</span><span class="o">.</span><span class="n">Marshal</span><span class="p">(</span><span class="n">usuario</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="n">log</span><span class="o">.</span><span class="n">Fatal</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="kt">string</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
    <span class="c">// Output: {"id":1,"nombre":"Ana García","email":"ana@ejemplo.com","activo":true,"etiquetas":["admin","desarrollador"]}</span>
    
    <span class="c">// JSON con formato legible</span>
    <span class="n">prettyData</span><span class="p">,</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">json</span><span class="o">.</span><span class="n">MarshalIndent</span><span class="p">(</span><span class="n">usuario</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span> <span class="s">"  "</span><span class="p">)</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="kt">string</span><span class="p">(</span><span class="n">prettyData</span><span class="p">))</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="12-deserialización-unmarshal">1.2 Deserialización (Unmarshal)</h3>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">deserializarJSON</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">jsonData</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">(</span><span class="s">`{
        "id": 2,
        "nombre": "Carlos López",
        "email": "carlos@ejemplo.com",
        "activo": false
    }`</span><span class="p">)</span>
    
    <span class="k">var</span> <span class="n">usuario</span> <span class="n">Usuario</span>
    <span class="n">err</span> <span class="o">:=</span> <span class="n">json</span><span class="o">.</span><span class="n">Unmarshal</span><span class="p">(</span><span class="n">jsonData</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">usuario</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="n">log</span><span class="o">.</span><span class="n">Fatal</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"Usuario: %+v</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">usuario</span><span class="p">)</span>
    <span class="c">// Output: Usuario: {ID:2 Nombre:Carlos López Email:carlos@ejemplo.com Activo:false Etiquetas:[]}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="2-tags-json">2. Tags JSON</h2>

<h3 id="21-tags-comunes">2.1 Tags Comunes</h3>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="n">Producto</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">ID</span>          <span class="kt">int</span>     <span class="s">`json:"id"`</span>
    <span class="n">Nombre</span>      <span class="kt">string</span>  <span class="s">`json:"nombre"`</span>
    <span class="n">Precio</span>      <span class="kt">float64</span> <span class="s">`json:"precio"`</span>
    <span class="n">Descripcion</span> <span class="kt">string</span>  <span class="s">`json:"descripcion,omitempty"`</span> <span class="c">// omitir si vacío</span>
    <span class="n">SKU</span>         <span class="kt">string</span>  <span class="s">`json:"-"`</span>                     <span class="c">// nunca incluir en JSON</span>
    <span class="n">Inventario</span>  <span class="kt">int</span>     <span class="s">`json:"inventario,string"`</span>     <span class="c">// salida como string</span>
    <span class="n">Creado</span>      <span class="kt">string</span>  <span class="s">`json:"creado"`</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="22-campos-privados-y-tags">2.2 Campos Privados y Tags</h3>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="n">Sesion</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">ID</span>        <span class="kt">string</span>    <span class="s">`json:"id"`</span>
    <span class="n">Usuario</span>   <span class="kt">string</span>    <span class="s">`json:"usuario"`</span>
    <span class="n">Expirado</span>  <span class="kt">bool</span>      <span class="s">`json:"expirado"`</span>
    <span class="n">creado</span>    <span class="n">time</span><span class="o">.</span><span class="n">Time</span> <span class="c">// no exportado, no incluido en JSON</span>
    <span class="n">UltimoUso</span> <span class="n">time</span><span class="o">.</span><span class="n">Time</span> <span class="s">`json:"ultimo_uso,omitempty"`</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="3-trabajo-con-streams">3. Trabajo con Streams</h2>

<h3 id="31-encoder-y-decoder">3.1 Encoder y Decoder</h3>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">streamJSON</span><span class="p">()</span> <span class="p">{</span>
    <span class="c">// Encoder</span>
    <span class="k">var</span> <span class="n">buf</span> <span class="n">bytes</span><span class="o">.</span><span class="n">Buffer</span>
    <span class="n">encoder</span> <span class="o">:=</span> <span class="n">json</span><span class="o">.</span><span class="n">NewEncoder</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">)</span>
    <span class="n">encoder</span><span class="o">.</span><span class="n">SetIndent</span><span class="p">(</span><span class="s">""</span><span class="p">,</span> <span class="s">"  "</span><span class="p">)</span>
    
    <span class="n">usuarios</span> <span class="o">:=</span> <span class="p">[]</span><span class="n">Usuario</span><span class="p">{</span>
        <span class="p">{</span><span class="n">ID</span><span class="o">:</span> <span class="m">1</span><span class="p">,</span> <span class="n">Nombre</span><span class="o">:</span> <span class="s">"Ana"</span><span class="p">},</span>
        <span class="p">{</span><span class="n">ID</span><span class="o">:</span> <span class="m">2</span><span class="p">,</span> <span class="n">Nombre</span><span class="o">:</span> <span class="s">"Bruno"</span><span class="p">},</span>
    <span class="p">}</span>
    
    <span class="k">if</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">Encode</span><span class="p">(</span><span class="n">usuarios</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="n">log</span><span class="o">.</span><span class="n">Fatal</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">buf</span><span class="o">.</span><span class="n">String</span><span class="p">())</span>
    
    <span class="c">// Decoder</span>
    <span class="n">decoder</span> <span class="o">:=</span> <span class="n">json</span><span class="o">.</span><span class="n">NewDecoder</span><span class="p">(</span><span class="n">strings</span><span class="o">.</span><span class="n">NewReader</span><span class="p">(</span><span class="n">buf</span><span class="o">.</span><span class="n">String</span><span class="p">()))</span>
    <span class="k">var</span> <span class="n">resultado</span> <span class="p">[]</span><span class="n">Usuario</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">decoder</span><span class="o">.</span><span class="n">Decode</span><span class="p">(</span><span class="o">&amp;</span><span class="n">resultado</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="n">log</span><span class="o">.</span><span class="n">Fatal</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"Decodificado: %+v</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">resultado</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="32-streaming-de-grandes-documentos">3.2 Streaming de Grandes Documentos</h3>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">procesarJSONGrande</span><span class="p">(</span><span class="n">r</span> <span class="n">io</span><span class="o">.</span><span class="n">Reader</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">decoder</span> <span class="o">:=</span> <span class="n">json</span><span class="o">.</span><span class="n">NewDecoder</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    
    <span class="c">// Leer token de apertura</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">decoder</span><span class="o">.</span><span class="n">Token</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="n">log</span><span class="o">.</span><span class="n">Fatal</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"Token inicial: %T: %v</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
    
    <span class="c">// Mientras sea un array</span>
    <span class="k">for</span> <span class="n">decoder</span><span class="o">.</span><span class="n">More</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">var</span> <span class="n">usuario</span> <span class="n">Usuario</span>
        <span class="k">if</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">decoder</span><span class="o">.</span><span class="n">Decode</span><span class="p">(</span><span class="o">&amp;</span><span class="n">usuario</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
            <span class="n">log</span><span class="o">.</span><span class="n">Fatal</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="n">procesarUsuario</span><span class="p">(</span><span class="n">usuario</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="c">// Leer token de cierre</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">decoder</span><span class="o">.</span><span class="n">Token</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="n">log</span><span class="o">.</span><span class="n">Fatal</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"Token final: %T: %v</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">procesarUsuario</span><span class="p">(</span><span class="n">u</span> <span class="n">Usuario</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"Procesando usuario: %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">Nombre</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="4-tipos-personalizados">4. Tipos Personalizados</h2>

<h3 id="41-implementando-marshalerunmarshaler">4.1 Implementando Marshaler/Unmarshaler</h3>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="n">Fecha</span> <span class="n">time</span><span class="o">.</span><span class="n">Time</span>

<span class="k">func</span> <span class="p">(</span><span class="n">f</span> <span class="n">Fecha</span><span class="p">)</span> <span class="n">MarshalJSON</span><span class="p">()</span> <span class="p">([]</span><span class="kt">byte</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">fecha</span> <span class="o">:=</span> <span class="n">time</span><span class="o">.</span><span class="n">Time</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fecha</span><span class="o">.</span><span class="n">IsZero</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">(</span><span class="s">`""`</span><span class="p">),</span> <span class="no">nil</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s">`"%s"`</span><span class="p">,</span> <span class="n">fecha</span><span class="o">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"2006-01-02"</span><span class="p">))),</span> <span class="no">nil</span>
<span class="p">}</span>

<span class="k">func</span> <span class="p">(</span><span class="n">f</span> <span class="o">*</span><span class="n">Fecha</span><span class="p">)</span> <span class="n">UnmarshalJSON</span><span class="p">(</span><span class="n">data</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
    <span class="k">var</span> <span class="n">fechaStr</span> <span class="kt">string</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">json</span><span class="o">.</span><span class="n">Unmarshal</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">fechaStr</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">err</span>
    <span class="p">}</span>
    
    <span class="k">if</span> <span class="n">fechaStr</span> <span class="o">==</span> <span class="s">""</span> <span class="p">{</span>
        <span class="o">*</span><span class="n">f</span> <span class="o">=</span> <span class="n">Fecha</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">Time</span><span class="p">{})</span>
        <span class="k">return</span> <span class="no">nil</span>
    <span class="p">}</span>
    
    <span class="n">fecha</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">time</span><span class="o">.</span><span class="n">Parse</span><span class="p">(</span><span class="s">"2006-01-02"</span><span class="p">,</span> <span class="n">fechaStr</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">err</span>
    <span class="p">}</span>
    
    <span class="o">*</span><span class="n">f</span> <span class="o">=</span> <span class="n">Fecha</span><span class="p">(</span><span class="n">fecha</span><span class="p">)</span>
    <span class="k">return</span> <span class="no">nil</span>
<span class="p">}</span>

<span class="k">type</span> <span class="n">Evento</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">Titulo</span>     <span class="kt">string</span> <span class="s">`json:"titulo"`</span>
    <span class="n">Fecha</span>      <span class="n">Fecha</span>  <span class="s">`json:"fecha"`</span>
    <span class="n">Asistentes</span> <span class="kt">int</span>    <span class="s">`json:"asistentes"`</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="42-uso-de-jsonrawmessage">4.2 Uso de json.RawMessage</h3>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="n">Mensaje</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">Tipo</span>    <span class="kt">string</span>          <span class="s">`json:"tipo"`</span>
    <span class="n">Datos</span>   <span class="n">json</span><span class="o">.</span><span class="n">RawMessage</span> <span class="s">`json:"datos"`</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">procesarMensajePolimórfico</span><span class="p">(</span><span class="n">jsonData</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">var</span> <span class="n">msg</span> <span class="n">Mensaje</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">json</span><span class="o">.</span><span class="n">Unmarshal</span><span class="p">([]</span><span class="kt">byte</span><span class="p">(</span><span class="n">jsonData</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="n">log</span><span class="o">.</span><span class="n">Fatal</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"Tipo de mensaje: %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">msg</span><span class="o">.</span><span class="n">Tipo</span><span class="p">)</span>
    
    <span class="k">switch</span> <span class="n">msg</span><span class="o">.</span><span class="n">Tipo</span> <span class="p">{</span>
    <span class="k">case</span> <span class="s">"usuario"</span><span class="o">:</span>
        <span class="k">var</span> <span class="n">usuario</span> <span class="n">Usuario</span>
        <span class="k">if</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">json</span><span class="o">.</span><span class="n">Unmarshal</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">Datos</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">usuario</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
            <span class="n">log</span><span class="o">.</span><span class="n">Fatal</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"Usuario: %+v</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">usuario</span><span class="p">)</span>
        
    <span class="k">case</span> <span class="s">"producto"</span><span class="o">:</span>
        <span class="k">var</span> <span class="n">producto</span> <span class="n">Producto</span>
        <span class="k">if</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">json</span><span class="o">.</span><span class="n">Unmarshal</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">Datos</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">producto</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
            <span class="n">log</span><span class="o">.</span><span class="n">Fatal</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"Producto: %+v</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">producto</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="5-manejo-de-estructuras-dinámicas">5. Manejo de Estructuras Dinámicas</h2>

<h3 id="51-mapstringinterface">5.1 Map[string]interface{}</h3>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">manejarJSONDinamico</span><span class="p">(</span><span class="n">jsonData</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">var</span> <span class="n">resultado</span> <span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="k">interface</span><span class="p">{}</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">json</span><span class="o">.</span><span class="n">Unmarshal</span><span class="p">([]</span><span class="kt">byte</span><span class="p">(</span><span class="n">jsonData</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">resultado</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="n">log</span><span class="o">.</span><span class="n">Fatal</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">resultado</span> <span class="p">{</span>
        <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"Clave: %s, Valor: %v (Tipo: %T)</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        
        <span class="c">// Manejar arrays</span>
        <span class="k">if</span> <span class="n">array</span><span class="p">,</span> <span class="n">ok</span> <span class="o">:=</span> <span class="n">v</span><span class="o">.</span><span class="p">([]</span><span class="k">interface</span><span class="p">{});</span> <span class="n">ok</span> <span class="p">{</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">array</span> <span class="p">{</span>
                <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"  [%d]: %v</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="c">// Manejar objetos anidados</span>
        <span class="k">if</span> <span class="n">obj</span><span class="p">,</span> <span class="n">ok</span> <span class="o">:=</span> <span class="n">v</span><span class="o">.</span><span class="p">(</span><span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="k">interface</span><span class="p">{});</span> <span class="n">ok</span> <span class="p">{</span>
            <span class="k">for</span> <span class="n">ck</span><span class="p">,</span> <span class="n">cv</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">obj</span> <span class="p">{</span>
                <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"  %s: %v</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">ck</span><span class="p">,</span> <span class="n">cv</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="52-validación-dinámica">5.2 Validación Dinámica</h3>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">validarJSON</span><span class="p">(</span><span class="n">jsonData</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">var</span> <span class="n">js</span> <span class="n">json</span><span class="o">.</span><span class="n">RawMessage</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">json</span><span class="o">.</span><span class="n">Unmarshal</span><span class="p">(</span><span class="n">jsonData</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">js</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="no">false</span><span class="p">,</span> <span class="n">err</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="no">true</span><span class="p">,</span> <span class="no">nil</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="6-mejores-prácticas">6. Mejores Prácticas</h2>

<h3 id="61-manejo-de-errores">6.1 Manejo de Errores</h3>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">manejoErroresSerialization</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">jsonData</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">(</span><span class="s">`{"id": "no-un-numero", "nombre": "Error"}`</span><span class="p">)</span>
    
    <span class="k">var</span> <span class="n">usuario</span> <span class="n">Usuario</span>
    <span class="n">err</span> <span class="o">:=</span> <span class="n">json</span><span class="o">.</span><span class="n">Unmarshal</span><span class="p">(</span><span class="n">jsonData</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">usuario</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="c">// Verificar tipo específico de error</span>
        <span class="k">var</span> <span class="n">syntaxErr</span> <span class="o">*</span><span class="n">json</span><span class="o">.</span><span class="n">SyntaxError</span>
        <span class="k">var</span> <span class="n">typeErr</span> <span class="o">*</span><span class="n">json</span><span class="o">.</span><span class="n">UnmarshalTypeError</span>
        
        <span class="k">switch</span> <span class="p">{</span>
        <span class="k">case</span> <span class="n">errors</span><span class="o">.</span><span class="n">As</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syntaxErr</span><span class="p">)</span><span class="o">:</span>
            <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"Error de sintaxis en posición %d: %v</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> 
                <span class="n">syntaxErr</span><span class="o">.</span><span class="n">Offset</span><span class="p">,</span> <span class="n">syntaxErr</span><span class="p">)</span>
            
        <span class="k">case</span> <span class="n">errors</span><span class="o">.</span><span class="n">As</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">typeErr</span><span class="p">)</span><span class="o">:</span>
            <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"Error de tipo al convertir %s a %s en posición %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> 
                <span class="n">typeErr</span><span class="o">.</span><span class="n">Value</span><span class="p">,</span> <span class="n">typeErr</span><span class="o">.</span><span class="n">Type</span><span class="p">,</span> <span class="n">typeErr</span><span class="o">.</span><span class="n">Offset</span><span class="p">)</span>
            
        <span class="k">default</span><span class="o">:</span>
            <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"Error deserializando JSON: %v</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">return</span>
    <span class="p">}</span>
    
    <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"Usuario: %+v</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">usuario</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="62-rendimiento">6.2 Rendimiento</h3>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">optimizacionesRendimiento</span><span class="p">()</span> <span class="p">{</span>
    <span class="c">// Uso de sync.Pool para reducir asignaciones de memoria</span>
    <span class="n">pool</span> <span class="o">:=</span> <span class="n">sync</span><span class="o">.</span><span class="n">Pool</span><span class="p">{</span>
        <span class="n">New</span><span class="o">:</span> <span class="k">func</span><span class="p">()</span> <span class="k">interface</span><span class="p">{}</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">byte</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">64</span><span class="o">*</span><span class="m">1024</span><span class="p">)</span> <span class="c">// 64KB buffer inicial</span>
        <span class="p">},</span>
    <span class="p">}</span>
    
    <span class="c">// Reutilizar buffer</span>
    <span class="n">buffer</span> <span class="o">:=</span> <span class="n">pool</span><span class="o">.</span><span class="n">Get</span><span class="p">()</span><span class="o">.</span><span class="p">([]</span><span class="kt">byte</span><span class="p">)</span>
    <span class="n">buffer</span> <span class="o">=</span> <span class="n">buffer</span><span class="p">[</span><span class="o">:</span><span class="m">0</span><span class="p">]</span> <span class="c">// reset length</span>
    
    <span class="k">var</span> <span class="n">buf</span> <span class="n">bytes</span><span class="o">.</span><span class="n">Buffer</span>
    <span class="n">buf</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span>
    
    <span class="c">// Codificar directamente al Writer</span>
    <span class="n">encoder</span> <span class="o">:=</span> <span class="n">json</span><span class="o">.</span><span class="n">NewEncoder</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">)</span>
    <span class="n">encoder</span><span class="o">.</span><span class="n">Encode</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span>
    
    <span class="c">// Hacer algo con buf.Bytes()</span>
    
    <span class="c">// Devolver buffer al pool</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">Put</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Esta guía proporciona una visión completa del paquete <code class="language-plaintext highlighter-rouge">encoding/json</code> en Go, desde operaciones básicas hasta técnicas avanzadas para manejar datos JSON de manera eficiente y flexible en tus aplicaciones.</p>

            </main>
        </div>
        
        <!-- Componente flotante de GitHub -->
<div class="github-floating">
    <a href="https://github.com/" target="_blank" rel="noopener noreferrer" class="github-link" title="Ver en GitHub">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github">
            <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
        </svg>
    </a>
    
    
    <a href="https://github.com//MiguelP-Dev.github.io/blob/main/_pages/paquetes/json.md" target="_blank" rel="noopener noreferrer" class="edit-link" title="Editar esta página">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2">
            <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>
        </svg>
    </a>
    
</div>

<style>
    /* Estilos del componente SVG */
    .github-corner:hover .octo-arm {
        animation: octocat-wave 560ms ease-in-out;
    }
    
    @keyframes octocat-wave {
        0%, 100% { transform: rotate(0); }
        20%, 60% { transform: rotate(-25deg); }
        40%, 80% { transform: rotate(10deg); }
    }
    
    @media (max-width: 500px) {
        .github-corner:hover .octo-arm {
            animation: none;
        }
        .github-corner .octo-arm {
            animation: octocat-wave 560ms ease-in-out;
        }
    }
</style>
    </div>
    
    <script src="/assets/js/scripts.js"></script>
</body>
</html>